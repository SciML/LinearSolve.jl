<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Preconditioners · LinearSolve.jl</title><meta name="title" content="Preconditioners · LinearSolve.jl"/><meta property="og:title" content="Preconditioners · LinearSolve.jl"/><meta property="twitter:title" content="Preconditioners · LinearSolve.jl"/><meta name="description" content="Documentation for LinearSolve.jl."/><meta property="og:description" content="Documentation for LinearSolve.jl."/><meta property="twitter:description" content="Documentation for LinearSolve.jl."/><meta property="og:url" content="https://docs.sciml.ai/LinearSolve/stable/basics/Preconditioners/"/><meta property="twitter:url" content="https://docs.sciml.ai/LinearSolve/stable/basics/Preconditioners/"/><link rel="canonical" href="https://docs.sciml.ai/LinearSolve/stable/basics/Preconditioners/"/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script><link href="../../assets/favicon.ico" rel="icon" type="image/x-icon"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../"><img src="../../assets/logo.png" alt="LinearSolve.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../">LinearSolve.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">LinearSolve.jl: High-Performance Unified Linear Solvers</a></li><li><span class="tocitem">Tutorials</span><ul><li><a class="tocitem" href="../../tutorials/linear/">Solving Linear Systems in Julia</a></li><li><a class="tocitem" href="../../tutorials/caching_interface/">Linear Solve with Caching Interface</a></li></ul></li><li><span class="tocitem">Basics</span><ul><li><a class="tocitem" href="../LinearProblem/">Linear Problems</a></li><li><a class="tocitem" href="../common_solver_opts/">Common Solver Options (Keyword Arguments for Solve)</a></li><li><a class="tocitem" href="../OperatorAssumptions/">Linear Solve Operator Assumptions</a></li><li class="is-active"><a class="tocitem" href>Preconditioners</a><ul class="internal"><li><a class="tocitem" href="#Using-Preconditioners"><span>Using Preconditioners</span></a></li><li><a class="tocitem" href="#Preconditioner-Interface"><span>Preconditioner Interface</span></a></li><li><a class="tocitem" href="#Curated-List-of-Pre-Defined-Preconditioners"><span>Curated List of Pre-Defined Preconditioners</span></a></li></ul></li><li><a class="tocitem" href="../FAQ/">Frequently Asked Questions</a></li></ul></li><li><span class="tocitem">Solvers</span><ul><li><a class="tocitem" href="../../solvers/solvers/">Linear System Solvers</a></li></ul></li><li><span class="tocitem">Advanced</span><ul><li><a class="tocitem" href="../../advanced/developing/">Developing New Linear Solvers</a></li><li><a class="tocitem" href="../../advanced/custom/">Passing in a Custom Linear Solver</a></li></ul></li><li><a class="tocitem" href="../../release_notes/">Release Notes</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Basics</a></li><li class="is-active"><a href>Preconditioners</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Preconditioners</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/SciML/LinearSolve.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/SciML/LinearSolve.jl/blob/main/docs/src/basics/Preconditioners.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="prec"><a class="docs-heading-anchor" href="#prec">Preconditioners</a><a id="prec-1"></a><a class="docs-heading-anchor-permalink" href="#prec" title="Permalink"></a></h1><p>Many linear solvers can be accelerated by using what is known as a <strong>preconditioner</strong>, an approximation to the matrix inverse action which is cheap to evaluate. These can improve the numerical conditioning of the solver process and in turn improve the performance. LinearSolve.jl provides an interface for the definition of preconditioners which works with the wrapped packages.</p><h2 id="Using-Preconditioners"><a class="docs-heading-anchor" href="#Using-Preconditioners">Using Preconditioners</a><a id="Using-Preconditioners-1"></a><a class="docs-heading-anchor-permalink" href="#Using-Preconditioners" title="Permalink"></a></h2><h3 id="Mathematical-Definition"><a class="docs-heading-anchor" href="#Mathematical-Definition">Mathematical Definition</a><a id="Mathematical-Definition-1"></a><a class="docs-heading-anchor-permalink" href="#Mathematical-Definition" title="Permalink"></a></h3><p>Preconditioners are specified in the keyword arguments to <code>init</code> or <code>solve</code>: <code>Pl</code> for left and <code>Pr</code> for right preconditioner, respectively. The right preconditioner, <span>$P_r$</span> transforms the linear system <span>$Au = b$</span> into the form:</p><p class="math-container">\[AP_r^{-1}(P_r u) = AP_r^{-1}y = b\]</p><p>which is solved for <span>$y$</span>, and then <span>$P_r u = y$</span> is solved for <span>$u$</span>. The left preconditioner, <span>$P_l$</span>, transforms the linear system into the form:</p><p class="math-container">\[P_l^{-1}Au = P_l^{-1}b\]</p><p>A two-sided preconditioned system is of the form:</p><p class="math-container">\[P_l^{-1}A P_r^{-1} (P_r u) = P_l^{-1}b\]</p><p>By default, if no preconditioner is given, the preconditioner is assumed to be the identity <span>$I$</span>.</p><h3 id="Using-Preconditioners-2"><a class="docs-heading-anchor" href="#Using-Preconditioners-2">Using Preconditioners</a><a class="docs-heading-anchor-permalink" href="#Using-Preconditioners-2" title="Permalink"></a></h3><p>In the following, we will use the <code>DiagonalPreconditioner</code> to define a two-sided preconditioned system which first divides by some random numbers and then multiplies by the same values. This is commonly used in the case where if, instead of random, <code>s</code> is an approximation to the eigenvalues of a system.</p><pre><code class="language-julia hljs">using LinearSolve, LinearAlgebra
n = 4
s = rand(n)
Pl = Diagonal(s)

A = rand(n, n)
b = rand(n)

prob = LinearProblem(A, b)
sol = solve(prob, KrylovJL_GMRES(), Pl = Pl)
sol.u</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">4-element Vector{Float64}:
   0.3162264144616228
 -35.8141154703237
  28.918442245034818
 -17.99181764902305</code></pre><h2 id="Preconditioner-Interface"><a class="docs-heading-anchor" href="#Preconditioner-Interface">Preconditioner Interface</a><a id="Preconditioner-Interface-1"></a><a class="docs-heading-anchor-permalink" href="#Preconditioner-Interface" title="Permalink"></a></h2><p>To define a new preconditioner you define a Julia type which satisfies the following interface:</p><ul><li><code>Base.eltype(::Preconditioner)</code> (Required only for Krylov.jl)</li><li><code>LinearAlgebra.ldiv!(::AbstractVector,::Preconditioner,::AbstractVector)</code> and <code>LinearAlgebra.ldiv!(::Preconditioner,::AbstractVector)</code></li></ul><h2 id="Curated-List-of-Pre-Defined-Preconditioners"><a class="docs-heading-anchor" href="#Curated-List-of-Pre-Defined-Preconditioners">Curated List of Pre-Defined Preconditioners</a><a id="Curated-List-of-Pre-Defined-Preconditioners-1"></a><a class="docs-heading-anchor-permalink" href="#Curated-List-of-Pre-Defined-Preconditioners" title="Permalink"></a></h2><p>The following preconditioners match the interface of LinearSolve.jl.</p><ul><li><p><code>LinearSolve.ComposePreconditioner(prec1,prec2)</code>: composes the preconditioners to apply <code>prec1</code> before <code>prec2</code>.</p></li><li><p><code>LinearSolve.InvPreconditioner(prec)</code>: inverts <code>mul!</code> and <code>ldiv!</code> in a preconditioner definition as a lazy inverse.</p></li><li><p><code>LinearAlgera.Diagonal(s::Union{Number,AbstractVector})</code>: the lazy Diagonal matrix type of Base.LinearAlgebra. Used for efficient construction of a diagonal preconditioner.</p></li><li><p>Other <code>Base.LinearAlgera</code> types: all define the full Preconditioner interface.</p></li><li><p><a href="https://github.com/haampie/IncompleteLU.jl">IncompleteLU.ilu</a>: an implementation of the incomplete LU-factorization preconditioner. This requires <code>A</code> as a <code>SparseMatrixCSC</code>.</p></li><li><p><a href="https://github.com/JuliaLinearAlgebra/Preconditioners.jl">Preconditioners.CholeskyPreconditioner(A, i)</a>: An incomplete Cholesky preconditioner with cut-off level <code>i</code>. Requires <code>A</code> as a <code>AbstractMatrix</code> and positive semi-definite.</p></li><li><p><a href="https://github.com/JuliaLinearAlgebra/AlgebraicMultigrid.jl">AlgebraicMultiGrid</a>: Implementations of the algebraic multigrid method. Must be converted to a preconditioner via <code>AlgebraicMultiGrid.aspreconditioner(AlgebraicMultiGrid.precmethod(A))</code>. Requires <code>A</code> as a <code>AbstractMatrix</code>. Provides the following methods:</p><ul><li><code>AlgebraicMultiGrid.ruge_stuben(A)</code></li><li><code>AlgebraicMultiGrid.smoothed_aggregation(A)</code></li></ul></li><li><p><a href="https://github.com/cortner/PyAMG.jl">PyAMG</a>: Implementations of the algebraic multigrid method. Must be converted to a preconditioner via <code>PyAMG.aspreconditioner(PyAMG.precmethod(A))</code>. Requires <code>A</code> as a <code>AbstractMatrix</code>. Provides the following methods:</p><ul><li><code>PyAMG.RugeStubenSolver(A)</code></li><li><code>PyAMG.SmoothedAggregationSolver(A)</code></li></ul></li><li><p><a href="https://github.com/mcovalt/ILUZero.jl">ILUZero.ILU0Precon(A::SparseMatrixCSC{T,N}, b_type = T)</a>: An incomplete LU implementation. Requires <code>A</code> as a <code>SparseMatrixCSC</code>.</p></li><li><p><a href="https://github.com/JuliaSmoothOptimizers/LimitedLDLFactorizations.jl">LimitedLDLFactorizations.lldl</a>: A limited-memory LDLᵀ factorization for symmetric matrices. Requires <code>A</code> as a <code>SparseMatrixCSC</code>. Applying <code>F = lldl(A); F.D .= abs.(F.D)</code> before usage as a preconditioner makes the preconditioner symmetric positive definite and thus is required for Krylov methods which are specialized for symmetric linear systems.</p></li><li><p><a href="https://github.com/tjdiamandis/RandomizedPreconditioners.jl">RandomizedPreconditioners.NystromPreconditioner</a> A randomized sketching method for positive semidefinite matrices <code>A</code>. Builds a preconditioner <span>$P ≈ A + μ*I$</span> for the system <span>$(A + μ*I)x = b$</span>.</p></li><li><p><a href="https://github.com/fredrikekre/HYPRE.jl">HYPRE.jl</a> A set of solvers with preconditioners which supports distributed computing via MPI. These can be written using the LinearSolve.jl interface choosing algorithms like <code>HYPRE.ILU</code> and <code>HYPRE.BoomerAMG</code>.</p></li></ul></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../OperatorAssumptions/">« Linear Solve Operator Assumptions</a><a class="docs-footer-nextpage" href="../FAQ/">Frequently Asked Questions »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="auto">Automatic (OS)</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.0.1 on <span class="colophon-date" title="Tuesday 26 September 2023 14:55">Tuesday 26 September 2023</span>. Using Julia version 1.9.3.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
